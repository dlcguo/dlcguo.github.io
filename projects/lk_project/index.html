<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Lucas-Kanade Video Tracking | Daniel Guo </title> <meta name="author" content="Daniel Guo"> <meta name="description" content="an implementation of 3 basic tracking algorithms"> <meta name="keywords" content="Daniel Guo, daniel guo, dguo3, dlcguo, CMU, cmu, carnegie mellon, carnegie mellon university, cmu courses, cmu course reviews, school of computer science, scs, machine learning, ml, computer science, cs"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/rawr-favicon.webp?bb4d50702c4649a67458f08378c7a0e5"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://dlcguo.github.io/projects/lk_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Daniel</span> Guo </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/summaries/">paper summaries </a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">cmu course reviews </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Lucas-Kanade Video Tracking</h1> <p class="post-description">an implementation of 3 basic tracking algorithms</p> </header> <article> <p>This project was for the Fall 2024 iteration of the Computer Vision (16-385) course, meaning the code cannot be made public. The task was essentially to replicate three variants of basic tracking algorithms using concepts covered during lecture: Lucas-Kanade Alignment with Translation, Lucas-Kanade Alignment with Affine Transformation, and Inverse Compositional Alignment with Affine Transformation.</p> <p>The Lucas-Kanade algorithm is an iterative optimization method for aligning an template image with a new image (current frame). The goal is to find the parameters of a warp \(W(x; p)\) that minimize the pixel-wise difference between the template and the warped image. This is achieved by solving the following minimization:</p> \[L(p) = \sum_x \left[ T(x) - I(W(x; p)) \right]^2\] <p>where \(T(x)\) is the template, \(I(W(x; p))\) is the warped image, and \(p\) represents the warp parameters.</p> <p>The algorithm assumes a close initial estimate of \(p\) and refines it by computing a small update \(\Delta p\). With linearization, the relation between the warp and the template can be expressed as a linear system. The solution for \(\Delta p\) is obtained using:</p> \[\Delta p = H^{-1} J^\top b\] <p>where</p> <ul> <li>\(H\) = Hessian matrix, capturing second-order information about the error</li> <li>\(J\) = Jacobian matrix, representing gradients of the error with respect to \(p\)</li> <li>\(b\) = Error vector, the difference between the template and the warped image</li> </ul> <p>The Inverse Compositional Alignment is an optimization of the Lucas-Kanade method to lower computational cost. It does this by precomputing the Jacobian and Hessian, which are constant when aligning a fixed template to a sequence of frames. The consequence is that we now focus on adjusting the warp parameters \(\Delta p\) that relate the template \(T\) to the current image \(I\). Therefore, we invert the roles of the template and current image (as compared to standard Lucas-Kanade) by solving for how the template \(T\) maps back to the image \(I\).</p> <p>This means that when iteratively updating \(p\), the inverse compositional method modifies the warp parameters \(\Delta p\) in the opposite direction as before. The updating equation becomes:</p> \[\Delta p = H^{-1} J^\top \left[I(W(x; p)) - T \right]\] <p>Our three chosen tracking algorithm variants differ in their flexibility and computational efficiency. The first variant, Lucas-Kanade with Translation, as the name suggests, focuses solely on translational motion by optimizing for \(x\) and \(y\) displacements. Because of this simplicity, this version is more computationally efficient than the other two variants. That said, it is therefore limited to scenarios that do not include rotation, scaling, and deformation.</p> <div class="row mt-3"> <div class="col-sm-6 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/video/projects/lucas_kanade/landing_lk_edit.mp4" class="img-fluid rounded z-depth-1 center" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Lucas-Kanade Alignment with Translation on landing video </div> <p>In this case, we can observe that the varying dimensions of the landing pad are not accounted for by the bounding box. However, this tracking algorithm is still able to capture the relative location of the target object.</p> <div class="row mt-3"> <div class="col-sm-6 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/video/projects/lucas_kanade/car2_lk_edit.mp4" class="img-fluid rounded z-depth-1 center" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Lucas-Kanade Alignment with Translation on car2 video </div> <p>We observe that the translation-based algorithm does properly track the target car. Hold this in memory–we will see an unexpected result when tracking the same car using the remaining variants.</p> <p>In contrast, Lucas-Kanade with Affine Transformation extends the model to account for more complex motions including rotation, scaling, and shearing. That is to say, <em>affine transformations</em>. Our implementation now optimizes six parameters to do so, offering greater accuracy/adaptability in aligning objects at the cost of increased computational complexity.</p> <div class="row mt-3"> <div class="col-sm-6 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/video/projects/lucas_kanade/landing_lk_affine_edit.mp4" class="img-fluid rounded z-depth-1 center" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Lucas-Kanade Alignment with Affine Transformation on landing video </div> <p>With the same landing video, we can see that our implementation is now able to properly adjust to the various sizes of the landing box.</p> <div class="row mt-3"> <div class="col-sm-6 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/video/projects/lucas_kanade/car2_lk_affine_edit.mp4" class="img-fluid rounded z-depth-1 center" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Lucas-Kanade Alignment with Affine Transformation on car2 video </div> <p>As mentioned prior, we see the surprising result that the more complex Lucas-Kanade algorithm is unable to properly track what the simpler version could. In particular, the affine transformation algorithm completely degenerates after the car is temporarily blocked by a traffic light. The reason is because once the target object is blocked, the computed residuals used for updating parameters become invalid, causing the warp matrix to diverge.</p> <p>Finally, we move on to the Inverse Compositional Alignment with Affine Transformation. We can essentially think of this algorithm as a weaker version of the standard affine Lucas-Kanade method. We are still able to handle affine transformations, albeit to less accuracy, while having less per-iteration computational overhead.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/projects/lucas_kanade/car1_lk_affine_edit.mp4" class="img-fluid rounded z-depth-1 center" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/projects/lucas_kanade/car1_ic_affine_edit.mp4" class="img-fluid rounded z-depth-1 center" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Lucas-Kanade Alignment with Affine Transformation on car1 video (left), Inverse Compositional Alignment with Affine Transformation on car1 video (right) </div> <p>The cost of decreasing computational complexity can be seen here. After the target car passes the bridge (which creates a brightness change), the more complex tracking algorithm on the left is able to continue tracking the car whereas the more efficient algorithm on the right fails.</p> <p>Overall, I had fun with this programming as it was my first experience with video tracking. While the end results were not perfect, they were more than satisfactory given the relatively basic nature of the algorithms.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Daniel Guo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: June 24, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script src="/assets/js/tooltips-setup.js?53023e960fbc64cccb90d32e9363de2b"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?5fdb75708acb79bd79b0cacb0ed0237d"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-RHBET73VVM"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-RHBET73VVM');
  </script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>